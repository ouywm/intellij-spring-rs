//! `SeaORM` Entity. Generated by spring-rs plugin

use sea_orm::entity::prelude::*;
#if($addSerde)
use serde::{Deserialize, Serialize};
#end
#if($needsDecimal)
use rust_decimal::Decimal;
#end
#if($hasTimestamps)
use sea_orm::Set;
#end

// === spring-rs generated START ===
// DO NOT EDIT between these markers. Re-generate to update.
#if($tableComment != "")

/// $tableComment
#end

#[derive(${baseDerives}#if($extraDerives != ""), ${extraDerives}#end)]
#[sea_orm(table_name = "$tableName")]
pub struct Model {
#foreach($column in $columns)
#if($column.comment != "")
    /// $column.comment
#end
#if($column.isPrimaryKey)
#if($column.isAutoIncrement)
    #[sea_orm(primary_key)]
#else
    #[sea_orm(primary_key, auto_increment = false)]
#end
#end
    pub $column.fieldName: $column.fullRustType,
#end
}

#if($hasRelations)
#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]
pub enum Relation {
#foreach($rel in $relations)
#if($rel.isBelongsTo)
    #[sea_orm(
        belongs_to = "$rel.targetEntityPath",
        from = "$rel.fromColumnPath",
        to = "$rel.toColumnPath"
    )]
    $rel.variantName,
#elseif($rel.isHasMany)
    #[sea_orm(has_many = "$rel.targetEntityPath")]
    $rel.variantName,
#elseif($rel.isHasOne)
    #[sea_orm(has_one = "$rel.targetEntityPath")]
    $rel.variantName,
#end
#end
}

#foreach($rel in $relations)
impl Related<$rel.targetEntityPath> for Entity {
    fn to() -> RelationDef {
        Relation::${rel.variantName}.def()
    }
}

#end
#else
#[derive(Copy, Clone, Debug, EnumIter, DeriveRelation)]
pub enum Relation {}

#end
#if($hasTimestamps)
#[async_trait::async_trait]
impl ActiveModelBehavior for ActiveModel {
    async fn before_save<C>(mut self, _db: &C, insert: bool) -> Result<Self, DbErr>
    where
        C: ConnectionTrait,
    {
        let now = ${timestampNowExpr};
#if($hasCreatedAt)
        if insert {
            self.$createdAtFieldName = Set(now);
        }
#end
#if($hasUpdatedAt)
        self.$updatedAtFieldName = Set(now);
#end
        Ok(self)
    }
}
#else
impl ActiveModelBehavior for ActiveModel {}
#end

// === spring-rs generated END ===
